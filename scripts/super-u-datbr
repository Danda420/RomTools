#!/bin/bash

DIRTOOLS=$PWD
DIRINPUT=$DIRTOOLS/rom_input
DIROUT=$DIRTOOLS/rom_output
DIRROM=$DIRTOOLS/ROM
clear
cd scripts

echo " "
echo " "
echo "Input Super image name :"
read
imgname=$REPLY
echo " "
while true; do
    read -p "Your super image name is : $imgname is that correct? (Y/N)" yn
    case $yn in
        [Yy]* ) break;;
        [Nn]* ) exit;;
        * ) echo "Please answer yes or no.";;
    esac
done

echo " "


brotli -d $DIRINPUT/$imgname.new.dat.br
rm -rf $DIRINPUT/$imgname.new.dat.br

./bin/sdat2img.py $DIRINPUT/$imgname.transfer.list $DIRINPUT/$imgname.new.dat $DIROUT/$imgname.img >> log.txt
rm -rf $DIRINPUT/$imgname.*

echo " "
echo "Unpacking $imgname.img..."
./bin/lpunpack $DIROUT/$imgname.img $DIRROM/super >> log.txt
rm -rf $DIROUT/$imgname.*

echo " "
echo "Done! Output : $DIRROM/super"

